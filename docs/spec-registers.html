<html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Registers · Ducky ISA</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Registers · Ducky ISA"/><meta property="og:type" content="website"/><meta property="og:url" content="https://ducky.happz.cz/index.html"/><meta property="og:description" content="## General Purpose Registers"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-dark.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/docusaurus.svg" alt="Ducky ISA"/><h2 class="headerTitle">Ducky ISA</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/intro.html" target="_self">Documentation</a></li><li class="siteNavGroupActive"><a href="/docs/toolchain.html" target="_self">Tools</a></li><li class="siteNavGroupActive"><a href="/docs/implementations.html" target="_self">Implementations</a></li><li class=""><a href="/docs/contribute.html" target="_self">Contribute</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>DuckyISA Specification</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Getting Started</h3><ul><li class="navListItem"><a class="navItem" href="/docs/intro.html">Introduction</a></li></ul></div><div class="navGroup navGroupActive"><h3>Tools</h3><ul><li class="navListItem"><a class="navItem" href="/docs/toolchain.html">Toolchain</a></li><li class="navListItem"><a class="navItem" href="/docs/libducky.html">libducky</a></li></ul></div><div class="navGroup navGroupActive"><h3>Implementations</h3><ul><li class="navListItem"><a class="navItem" href="/docs/implementations.html">Cores and emulators</a></li><li class="navListItem"><a class="navItem" href="/docs/qemu.html">QEMU</a></li><li class="navListItem"><a class="navItem" href="/docs/mallard.html">&quot;Mallard&quot; Board</a></li></ul></div><div class="navGroup navGroupActive"><h3>Apps</h3><ul><li class="navListItem"><a class="navItem" href="/docs/examples.html">Examples</a></li><li class="navListItem"><a class="navItem" href="/docs/ducky-forth.html">Ducky FORTH</a></li><li class="navListItem"><a class="navItem" href="/docs/micropython.html">MicroPython</a></li></ul></div><div class="navGroup navGroupActive"><h3>DuckyISA Specification</h3><ul><li class="navListItem"><a class="navItem" href="/docs/spec-terms.html">Terms</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/spec-registers.html">Registers</a></li><li class="navListItem"><a class="navItem" href="/docs/spec-memory-model.html">Memory model</a></li><li class="navListItem"><a class="navItem" href="/docs/spec-evt.html">Exception Vector Table</a></li><li class="navListItem"><a class="navItem" href="/docs/spec-instruction-set.html">Instruction Set</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Registers</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="general-purpose-registers"></a><a href="#general-purpose-registers" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>General Purpose Registers</h2>
<p><strong>DuckyISA</strong> provides 32 32-bit registers:</p>
<ul>
<li><code>r0</code> to <code>r29</code> are general purpose registers</li>
<li><code>r30</code> is nicknamed <code>fp</code> and serves as a frame pointer</li>
<li><code>r31</code> is nicknamed <code>sp</code> and serves as a stack pointer</li>
</ul>
<p>Both <code>fp</code> and <code>sp</code> can be manipulated by common instructions, but both are used by instructions implementing calls and returns and such instructions may read or write their content as well.</p>
<h2><a class="anchor" aria-hidden="true" id="flags-register"></a><a href="#flags-register" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Flags register</h2>
<p>Flags register is a read-only pseudo-register. It is not possible to change its value by writing into it, yet its value is modified by some instructions by reflecting their effects on the CPU core.</p>
<table>
<thead>
<tr><th style="text-align:center">Mask</th><th style="text-align:center">Flag</th><th>Usage</th></tr>
</thead>
<tbody>
<tr><td style="text-align:center"><code>0x00</code></td><td style="text-align:center"><code>P</code></td><td>If set, CCPU core runs in a privileged mode, and it is possible to run protected instructions.</td></tr>
<tr><td style="text-align:center"><code>0x01</code></td><td style="text-align:center"><code>H</code></td><td>If set, hardware interrupts can be delivered to the CPU core.</td></tr>
<tr><td style="text-align:center"><code>0x02</code></td><td style="text-align:center"></td><td>Reserved.</td></tr>
<tr><td style="text-align:center"><code>0x04</code></td><td style="text-align:center"><code>E</code></td><td>Set when the last two compared values were equal.</td></tr>
<tr><td style="text-align:center"><code>0x08</code></td><td style="text-align:center"><code>Z</code></td><td>Set when the last instruction produced zero.</td></tr>
<tr><td style="text-align:center"><code>0x10</code></td><td style="text-align:center"><code>O</code></td><td>Set when the last instruction produced value too large to fit into a register.</td></tr>
<tr><td style="text-align:center"><code>0x20</code></td><td style="text-align:center"><code>S</code></td><td>Set when the last instruction produced value with the highest bit set.</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="instruction-pointer"></a><a href="#instruction-pointer" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Instruction Pointer</h2>
<p>The Instruction Pointer register (<code>IP</code>) is a hidden register, 32 bits wide, holding the address of the instruction that will be executed next. It is not possible to modify it directly, it is however saved to and restored from a stack during routine calls and exception handling.</p>
<h2><a class="anchor" aria-hidden="true" id="control-registers"></a><a href="#control-registers" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Control registers</h2>
<p>Control registers allow inspection or modification of various runtime properties of the CPU core.</p>
<p>Access to these registers is allowed only in privileged mode (i.e. <code>P</code> flag is set).</p>
<h3><a class="anchor" aria-hidden="true" id="cr0"></a><a href="#cr0" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>CR0</code></h3>
<p><code>cr0</code> register contains so-called <em>CPUID</em> value which identifies location of the CPU in a global system topology when system can have multiple CPUs, each with multiple cores.</p>
<pre><code class="hljs">31             16 15             0
<span class="hljs-section"> v              v v              v
+----------------+----------------+</span>
<span class="hljs-section">| CPU            | core           |
+----------------+----------------+</span>
</code></pre>
<p>There is always a core whose <code>cr0</code> contains <code>0x00000000</code> since there's always at least a CPU with at least one core.</p>
<p>This register is read-only.</p>
<h3><a class="anchor" aria-hidden="true" id="cr1"></a><a href="#cr1" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>CR1</code></h3>
<p>Contains address of Exception Vector Table of this core.</p>
<blockquote>
<p>Be aware that <strong>any</strong> address is accepted - no aligment or any other restrictions are enforced.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="cr2"></a><a href="#cr2" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>CR2</code></h3>
<p>Contains contains Page Table address of this core.</p>
<blockquote>
<p>Be aware that <strong>any</strong> address is accepted - no aligment or any other restrictions are enforced.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="cr3"></a><a href="#cr3" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>CR3</code></h3>
<p>Contains several flags describing behavior of the core.</p>
<table>
<thead>
<tr><th>Mask</th><th style="text-align:center">Flag</th><th style="text-align:center">Access</th><th>Usage</th></tr>
</thead>
<tbody>
<tr><td><code>0x00</code></td><td style="text-align:center"><code>PTE</code></td><td style="text-align:center">RW</td><td>If set, page tables are enabled and every memory access is affected by their configuration.</td></tr>
<tr><td><code>0x02</code></td><td style="text-align:center"><code>EM</code></td><td style="text-align:center">R-</td><td>If set, the core is being emulated. Hardware implementations must return zero.</td></tr>
<tr><td><code>0x04</code></td><td style="text-align:center"><code>JIT</code></td><td style="text-align:center">R-</td><td>If set, JIT optimizations are enabled. Valid only when <code>EM</code> is set.</td></tr>
<tr><td><code>0x08</code></td><td style="text-align:center"><code>VMDBG</code></td><td style="text-align:center">RW</td><td>If set, core will produce huge amount of debugging logs. Valid only when <code>EM</code> is set.</td></tr>
</tbody>
</table>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="spec-terms.html">← Terms</a><a class="docs-next button" href="spec-memory-model.html">Memory model →</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#general-purpose-registers">General Purpose Registers</a></li><li><a href="#flags-register">Flags register</a></li><li><a href="#instruction-pointer">Instruction Pointer</a></li><li><a href="#control-registers">Control registers</a><ul class="toc-headings"><li><a href="#cr0"><code>CR0</code></a></li><li><a href="#cr1"><code>CR1</code></a></li><li><a href="#cr2"><code>CR2</code></a></li><li><a href="#cr3"><code>CR3</code></a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/docusaurus.svg" alt="Ducky ISA" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/docs/en/doc2.html">Guides (or other categories)</a><a href="/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" href="https://github.com/facebook/test-site" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2018 Milos Prchlik &lt;happz@happz.cz&gt;</section></footer></div></body></html>